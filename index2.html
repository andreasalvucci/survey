<html>

<head>
 <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.indigo-pink.min.css">
<script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>
<!-- Stepper CSS minified -->
<link rel="stylesheet" href="./stepper.min.css">
<!-- Stepper Javascript minified -->
<script defer src="./stepper.min.js"></script>
  
    <title>Sono vittima?</title>
</head>

<body>
  
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header
    mdl-layout--fixed-tabs">
        <header class="mdl-layout__header">
            <div class="mdl-layout__header-row">
                <!-- Title -->
                <span class="mdl-layout-title">Title</span>
            </div>
    </header>
          
          
<ul class="mdl-stepper mdl-stepper--linear mdl-stepper--horizontal" id="demo-stepper-linear">
  <li class="mdl-step">
    <span class="mdl-step__label">
              <span class="mdl-step__title">
                <span class="mdl-step__title-text">Inserimento e-mail</span>
    </span>
       </span>
    <div class="mdl-step__content">
      CIOOOO
      <p>Benvenut* a questa indagine sui data breach, se parteciperai potrai scoprire se sei stat* vittima
                        di esfiltrazione di dati personali.</p>
                    <p>Ti vogliamo assicurare che la tua e-mail non verr√† memorizzata da nessuna parte e che i tuoi dati
                        verranno trattati in modo completamente anonimo</p>
                    <p> Per favore, inserisci qui il tuo indirizzo e-mail</p>
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="text" id="email" name="email"><br><br>
                        <label class="mdl-textfield__label" for="email">Indirizzo e-mail...</label>
                    </div>
    </div>
    <div class="mdl-step__actions">
      <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored mdl-button--raised" onclick="myAPI()" data-stepper-next>
            Continua
          </button>
      <button class="mdl-button mdl-js-button mdl-js-ripple-effect" data-stepper-cancel>
            Cancel
          </button>
    </div>
  </li>
  
  <li class="mdl-step">
    <span class="mdl-step__label">
          <span class="mdl-step__title">
            <span class="mdl-step__title-text">Title longer than it should be</span>
    </span>
    </span>
    <div class="mdl-step__content">
    <div id="container-lista">
                    <h2>Ouch! Il tuo indirizzo e-mail e' stato trovato in ben <a id="numero_breach">N</a> data
                        breach!</h3>
                        <h3>Potresti darmi una mano con il <a href="index.html#fixed-tab-3">sondaggio</a> alla tua destra?
                    </h2>
                    <ul class='mdl-list' id="lista">
                    </ul>
                </div>
    </div>
    <div class="mdl-step__actions">
      <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored mdl-button--raised" data-stepper-next>
            Continue
          </button>
      <button class="mdl-button mdl-js-button mdl-js-ripple-effect" data-stepper-cancel>
            Cancel
          </button>
    </div>
  </li>
  
  <li class="mdl-step">
    <span class="mdl-step__label">
          <span class="mdl-step__title">
            <span class="mdl-step__title-text">Title of step 3</span>
    </span>
    </span>
    <div class="mdl-step__content"></div>
    <div class="mdl-step__actions">
      <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored mdl-button--raised" data-stepper-next>
            Continue
          </button>
      <button class="mdl-button mdl-js-button mdl-js-ripple-effect" data-stepper-cancel>
            Cancel
          </button>
    </div>
  </li>
</ul>
  
  
  
  <script>
  (function () {
    var selector = '.mdl-stepper#demo-stepper-linear';
    // Select stepper container element      
    var stepperElement = document.querySelector(selector);
    var Stepper;
    var steps;
    
    if (!stepperElement) return;
    
    // Get the MaterialStepper instance of element to control it.          
    Stepper = stepperElement.MaterialStepper;
    
    if (!Stepper) {
      console.error('MaterialStepper instance is not available for selector: ' + selector + '.');
      return;
    }
    steps = stepperElement.querySelectorAll('.mdl-step');

    for (var i = 0; i < steps.length; i++) {
      // When user clicks on [data-stepper-next] button of step.          
      steps[i].addEventListener('onstepnext', function (e) {
        // {element}.MaterialStepper.next() change the state of current step to "completed" 
        // and move one step forward.        
        Stepper.next();              
      });
    }

    // When all steps are completed this event is dispatched.          
    stepperElement.addEventListener('onsteppercomplete', function (e) {
      var toast = document.querySelector('#snackbar-stepper-complete');

      if (!toast) return;

      toast.MaterialSnackbar.showSnackbar({
        message: 'Stepper linear are completed',
        timeout: 4000,
        actionText: 'Ok'
      });
    });
  })();

  (function () {
    var toggle = document.querySelector('[href="#stepper-linear-toggle"]');
    var snippetDirections = document.querySelector('#snippet-stepper-linear');
    var stepperElement = snippetDirections.querySelector('.mdl-stepper');
    var cssClassHorizontal = 'mdl-stepper--horizontal';

    toggle.addEventListener('click', function (event) {
      event.preventDefault();
      
      if (!stepperElement) return;

      if (stepperElement.classList.contains(cssClassHorizontal)) {
        stepperElement.classList.remove(cssClassHorizontal);
      } else {
        stepperElement.classList.add(cssClassHorizontal);        
      }
    });
  })();

</script>
  
<script type="text/javascript">
        function myAPI() {
            email = document.getElementById("email").value;

            console.log('la mail selezionata e' + email)


            fetch('./hibp?email=' + email)
                .then(response => response.json())
                .then(data => printBreach(data))
                .catch(e => console.log(e));


        }

        function printBreach(data) {
            invisibile("google_form");
            console.log(data.ok);
            if (data.ok == "ok") {
                invisibile("container-lista");
                visibile("ok")
            }
            else {
                invisibile("ok");
                visibile("container-lista");
                visibile("vittima");
                lista = document.getElementById("lista");
                emptyList("lista");
                console.log(data);
                document.getElementById("numero_breach").innerHTML = data.length;
                for (i in data) {
                    breach = data[i];
                    elemento = document.createElement('li');
                    elemento.className = "mdl-list__item";
                    span = document.createElement('span');
                    span.className = "mdl-list__item-primary-content"
                    elemento.appendChild(span);
                    lista.appendChild(elemento);
                    elemento.innerHTML = elemento.innerHTML + breach.Name;
                }
                visibile("google_form");
            }
        }

        function toggleDiv(id) {
            var div = document.getElementById(id);
            div.style.display = div.style.display == "none" ? "block" : "none";
        }

        function invisibile(id) {
            var div = document.getElementById(id);
            div.style.display = "none";

        }
        function visibile(id) {
            var div = document.getElementById(id);
            div.style.display = "block";

        }
        function emptyList(id) {
            root = document.getElementById(id);
            while (root.firstChild) {
                root.removeChild(root.firstChild);
            }
        }

        function inizio() {
            invisibile("vittima");
            invisibile("google_form");
            invisibile("ok");
            invisibile("container-lista");
        }
    </script>
    </div>
</body>

</html>